<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard | Administrador</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard_admin.css') }}">
  <link rel="stylesheet" href="/static/css/generic.css">
  <link rel="stylesheet" href="/static/css/dashboard.css">

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>

  </style>
</head>
    <body>

    <header>
        <div class="logo">
        <nav class="menu">
            <ul>
                <li><a href="/dashboard_administrador">Dashboard</a></li>

                <!-- Gesti√≥n (submen√∫) -->
                <li class="dropdown">
                    <a href="#">Gesti√≥n ‚ñº</a>
                    <ul class="submenu">
                        <li><a href="/registro_usuarios">Usuarios</a></li>
                        <li><a href="/registro_paciente_animal">Pacientes</a></li>
                        <li><a href="/listar_consulta">Consultas</a></li>
                        <li><a href="/listar_procedimientos">Procedimientos Quir√∫rgicos</a></li>
                        <li><a href="/gestion_insumos">Insumos</a></li>
                        <li><a href="/medicamento">Medicamentos</a></li>
                        <li><a href="/registrar_animal_rescatado">Animales Rescatados</a></li>
                        <li><a href="/carne_vacunas">Carn√© de Vacunas</a></li>
                        <li><a href="/jornadas">Jornadas</a></li>
                    </ul>
                </li>

                <!-- Animales -->
                

                <!-- Donaciones (submen√∫) -->
                <li class="dropdown">
                    <a href="#">Donaciones ‚ñº</a>
                    <ul class="submenu">
                        <li><a href="/registrar_donacion">Medicamentos</a></li>
                        <li><a href="/donaciones_alimentos">Alimentos</a></li>
                    </ul>
                </li>
            </ul>

            <div class="btn-group">
                <a href="{{ url_for('rutas_login.login') }}" class="btn-cupo">üîí Cerrar Sesi√≥n</a>
            </div>
        </nav>
    </header>

    <main class="dashboard-container">

        <div class="mensaje-bienvenida">
            <h1>Bienvenido, {{ session['nombre'] }} {{ session['apellido'] }} </h1>
            <h2>Panel de Administraci√≥n</h2>
        </div>
        
        <!-- M√©tricas r√°pidas -->
        <div class="cards">
            <div class="card"><h2>üë• Usuarios</h2><p>{{ total_usuarios }}</p></div>
            <div class="card"><h2>üê∂ Animales</h2><p>{{ total_animales }}</p></div>
        </div>

        <!-- Gr√°ficos -->
        <div class="charts-grid">
            <div>
            <h3>Usuarios por Rol</h3>
            <canvas id="usuariosRol"></canvas>
            </div>
            <div>
            <h3>Donaciones</h3>
            <canvas id="donaciones"></canvas>
            </div>
            <div>
            <h3>Insumos por vencer</h3>
            <canvas id="insumos"></canvas>
            </div>
            <div>
            <h3>Medicamentos por Vencer (30 d√≠as)</h3>
            <canvas id="chartMedicamentosVencer"></canvas>
            </div>
        </div>
    </main>
        
        <footer>
            <div>
                Copyright ¬© 2025 Developed by Trio Imperial co.
            </div>

            <div>
                Powered by Petfriendly
            </div>
        </footer>

        <script>
  // Usuarios por Rol
    new Chart(document.getElementById('usuariosRol'), {
        type: 'doughnut',
        data: {
            labels: {{ roles_labels|safe }},
            datasets: [{
                data: {{ roles_data|safe }},
                backgroundColor: ['#36A2EB', '#4BC0C0', '#FFCD56']
            }]
        }
    });

  // Donaciones
    new Chart(document.getElementById('donaciones'), {
        type: 'bar',
        data: {
            labels: {{ donaciones_labels|safe }},
            datasets: [{
                label: 'Cantidad',
                data: {{ donaciones_data|safe }},
                backgroundColor: ['#FF6384','#36A2EB']
            }]
        }
    });

  // Insumos por vencer
    new Chart(document.getElementById('insumos'), {
        type: 'bar',
        data: {
            labels: {{ insumos_labels|safe }},
            datasets: [{
                label: 'Cantidad disponible',
                data: {{ insumos_data|safe }},
                backgroundColor: '#FF9F40'
            }]
        },
        options: {
            indexAxis: 'y'
        }
    });

    const ctxMed = document.getElementById('chartMedicamentosVencer').getContext('2d');
    new Chart(ctxMed, {
        type: 'bar',
        data: {
        labels: {{ medicamentos_labels|safe }},
        datasets: [{
            label: 'Existencia',
            data: {{ medicamentos_data|safe }},
            backgroundColor: 'rgba(54, 162, 235, 0.7)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
        }]
        },
        options: {
        indexAxis: 'y', // üëà esto lo hace HORIZONTAL
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: { position: 'top' },
            title: {
            display: true,
            text: 'Medicamentos pr√≥ximos a vencer'
            }
        },
        scales: {
            x: {
            beginAtZero: true,
            ticks: { stepSize: 5 }
            }
        }
        }
    });
</script>
    </body>
        </html>
